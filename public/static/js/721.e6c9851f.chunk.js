"use strict";(self.webpackChunkbuild_frontend=self.webpackChunkbuild_frontend||[]).push([[721],{8721:function(e,n,a){a.r(n),a.d(n,{default:function(){return O}});var t=a(4165),r=a(5861),i=a(1413),s=a(9439),l=a(2791),o=a(7689),c=a(184),u=function(e){return(0,c.jsx)("div",{className:"card ".concat(e.className),style:e.style,children:e.children})},d=a(7762),p="REQUIRE",h="MINLENGTH",m="MAXLENGTH",v="EMAIL",f=function(){return{type:p}},x=function(e,n){var a,t=!0,r=(0,d.Z)(n);try{for(r.s();!(a=r.n()).done;){var i=a.value;i.type===p&&(t=t&&e.trim().length>0),i.type===h&&(t=t&&e.trim().length>=i.val),i.type===m&&(t=t&&e.trim().length<=i.val),"MIN"===i.type&&(t=t&&+e>=i.val),"MAX"===i.type&&(t=t&&+e<=i.val),i.type===v&&(t=t&&/^\S+@\S+\.\S+$/.test(e))}}catch(s){r.e(s)}finally{r.f()}return t},j=function(e,n){switch(n.type){case"CHANGE":return(0,i.Z)((0,i.Z)({},e),{},{value:n.val,isValid:x(n.val,n.validators)});case"TOUCH":return(0,i.Z)((0,i.Z)({},e),{},{isTouched:!0});default:return e}},b=function(e){var n=(0,l.useReducer)(j,{value:e.initialValue||"",isTouched:!1,isValid:e.initialValid||!1}),a=(0,s.Z)(n,2),t=a[0],r=a[1],i=e.id,o=e.onInput,u=t.value,d=t.isValid;(0,l.useEffect)((function(){o(i,u,d)}),[i,u,d,o]);var p=function(n){r({type:"CHANGE",val:n.target.value,validators:e.validators})},h=function(){r({type:"TOUCH"})},m="input"===e.element?(0,c.jsx)("input",{id:e.id,type:e.type,placeholder:e.placeHolder,onChange:p,onBlur:h,value:t.value,maxLength:e.maxLength}):(0,c.jsx)("textarea",{id:e.id,rows:e.rows||3,onChange:p,onBlur:h,value:t.value});return(0,c.jsxs)("div",{className:"form-control ".concat(!t.isValid&&t.isTouched&&"form-control--invalid"),children:[(0,c.jsx)("label",{htmlFor:e.id,children:e.label}),m,!t.isValid&&t.isTouched&&(0,c.jsx)("p",{children:e.errorText})]})},g=a(1087),y=function(e){return e.href?(0,c.jsx)("a",{className:"button button--".concat(e.size||"default"," ").concat(e.inverse&&"button--inverse"," ").concat(e.danger&&"button--danger"),href:e.href,children:e.children}):e.to?(0,c.jsx)(g.rU,{to:e.to,exact:e.exact,className:"button button--".concat(e.size||"default"," ").concat(e.inverse&&"button--inverse"," ").concat(e.danger&&"button--danger"),children:e.children}):(0,c.jsx)("button",{className:"button button--".concat(e.size||"default"," ").concat(e.inverse&&"button--inverse"," ").concat(e.danger&&"button--danger"),type:e.type,onClick:e.onClick,disabled:e.disabled,children:e.children})},N=a(4164),C=a(9422),k=a(6928),w=function(e){var n=(0,c.jsxs)("div",{className:"modal ".concat(e.className),style:e.style,children:[(0,c.jsx)("header",{className:"modal__header ".concat(e.headerClass),children:(0,c.jsx)("h2",{children:e.header})}),(0,c.jsxs)("form",{onSubmit:e.onSubmit?e.onSubmit:function(e){return e.preventDefault()},children:[(0,c.jsx)("div",{className:"modal__content ".concat(e.contentClass),children:e.children}),(0,c.jsx)("footer",{className:"modal__footer ".concat(e.footerClass),children:e.footer})]})]});return N.createPortal(n,document.getElementById("modal-hook"))},Z=function(e){return(0,c.jsxs)(l.Fragment,{children:[e.show&&(0,c.jsx)(C.Z,{onClick:e.onCancel}),(0,c.jsx)(k.Z,{in:e.show,mountOnEnter:!0,unmountOnExit:!0,timeout:200,classNames:"modal",children:(0,c.jsx)(w,(0,i.Z)({},e))})]})},I=function(e){return(0,c.jsx)(Z,{onCancel:e.onClear,header:"An Error Occurred! (frontend)",show:!!e.error,footer:(0,c.jsx)(y,{onClick:e.onClear,children:"Okay"}),children:(0,c.jsx)("p",{children:e.error})})},T=a(9895),V=function(e){var n=(0,l.useState)(),a=(0,s.Z)(n,2),t=a[0],r=a[1],i=(0,l.useState)(),o=(0,s.Z)(i,2),u=o[0],d=o[1],p=(0,l.useState)(!1),h=(0,s.Z)(p,2),m=h[0],v=h[1],f=(0,l.useRef)();(0,l.useEffect)((function(){if(t){var e=new FileReader;e.onload=function(){d(e.result)},e.readAsDataURL(t)}}),[t]);return(0,c.jsxs)("div",{className:"form-control",children:[(0,c.jsx)("input",{id:e.id,ref:f,style:{display:"none"},type:"file",accept:".jpg,.png,.jpeg",onChange:function(n){var a,t=m;n.target.files&&1===n.target.files.length?(a=n.target.files[0],r(a),v(!0),t=!0):(v(!1),t=!1),e.onInput(e.id,a,t)}}),(0,c.jsxs)("div",{className:"image-upload ".concat(e.center&&"center"),children:[(0,c.jsxs)("div",{className:"image-upload__preview",children:[u&&(0,c.jsx)("img",{src:u,alt:"Preview"}),!u&&(0,c.jsx)("p",{children:"Please pick an image."})]}),(0,c.jsx)(y,{type:"button",onClick:function(){f.current.click()},children:"PICK IMAGE"})]}),!m&&(0,c.jsx)("p",{children:e.errorText})]})},E=a(4942),S=function(e,n){switch(n.type){case"INPUT_CHANGE":var a=!0;for(var t in e.inputs)e.inputs[t]&&(a=t===n.inputId?a&&n.isValid:a&&e.inputs[t].isValid);return(0,i.Z)((0,i.Z)({},e),{},{inputs:(0,i.Z)((0,i.Z)({},e.inputs),{},(0,E.Z)({},n.inputId,{value:n.value,isValid:n.isValid})),isValid:a});case"SET_DATA":return{inputs:n.inputs,isValid:n.formIsValid};default:return e}},P=a(9508),A=a(3108),_=a(2074),O=function(){var e,n=(0,l.useContext)(A.V),a=(0,l.useState)(!0),d=(0,s.Z)(a,2),p=d[0],m=d[1],x=(0,P.x)(),j=x.isLoading,g=x.error,N=x.sendRequest,C=x.clearError,k=(0,o.s0)(),w=function(e,n){var a=(0,l.useReducer)(S,{inputs:e,isValid:n}),t=(0,s.Z)(a,2),r=t[0],i=t[1];return[r,(0,l.useCallback)((function(e,n,a){i({type:"INPUT_CHANGE",value:n,isValid:a,inputId:e})}),[]),(0,l.useCallback)((function(e,n){i({type:"SET_DATA",inputs:e,formIsValid:n})}),[])]}({email:{value:"",isValid:!1},password:{value:"",isValid:!1}},!1),Z=(0,s.Z)(w,3),E=Z[0],O=Z[1],G=Z[2],H=function(){var e=(0,r.Z)((0,t.Z)().mark((function e(a){var r,i,s;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.preventDefault(),!p){e.next=15;break}return e.prev=2,e.next=5,N("https://barber-shop-kr-cc7d4a32607d.herokuapp.com/api/users/login","POST",JSON.stringify({email:E.inputs.email.value,password:E.inputs.password.value}),{"Content-Type":"application/json"});case 5:r=e.sent,n.login(r.userId,r.token),k("/book"),window.location.reload(),e.next=13;break;case 11:e.prev=11,e.t0=e.catch(2);case 13:e.next=32;break;case 15:return e.prev=15,(i=new FormData).append("email",E.inputs.email.value),i.append("name",E.inputs.name.value),i.append("phone",E.inputs.phone.value),i.append("password",E.inputs.password.value),i.append("image",E.inputs.image.value),e.next=24,N("https://barber-shop-kr-cc7d4a32607d.herokuapp.com/api/users/signup","POST",i);case 24:s=e.sent,n.login(s.userId,s.token),k("/book"),window.location.reload(),e.next=32;break;case 30:e.prev=30,e.t1=e.catch(15);case 32:case"end":return e.stop()}}),e,null,[[2,11],[15,30]])})));return function(n){return e.apply(this,arguments)}}();return(0,c.jsxs)("div",{className:"main-container",children:[(0,c.jsx)(I,{error:g,onClear:C}),(0,c.jsxs)(u,{className:"authentication",children:[j&&(0,c.jsx)(T.Z,{asOverlay:!0}),(0,c.jsx)("h2",{children:"Login Required"}),(0,c.jsx)("hr",{}),(0,c.jsxs)("form",{onSubmit:H,children:[!p&&(0,c.jsx)(b,{element:"input",id:"name",type:"text",label:"Your Name",validators:[f()],errorText:"Please enter a name.",onInput:O}),!p&&(0,c.jsx)(b,{element:"input",id:"phone",type:"tel",label:"Phone Number",validators:[f()],errorText:"Please enter a valid phone number",onInput:O,maxLength:11,placeHolder:"Enter phone number"}),!p&&(0,c.jsx)(V,{center:!0,id:"image",onInput:O,errorText:"Please provide an image."}),(0,c.jsx)(b,{element:"input",id:"email",type:"email",label:"E-Mail",validators:[{type:v}],errorText:"Please enter a valid email address.",onInput:O}),(0,c.jsx)(b,{element:"input",id:"password",type:"password",label:"Password",validators:[(e=6,{type:h,val:e})],errorText:"Please enter a valid password, at least 6 characters.",onInput:O}),(0,c.jsx)(y,{type:"submit",disabled:!E.isValid,children:p?"LOGIN":"SIGNUP"})]}),(0,c.jsxs)(y,{inverse:!0,onClick:function(){p?G((0,i.Z)((0,i.Z)({},E.inputs),{},{name:{value:"",isValid:!1},image:{value:null,isValid:!1}}),!1):G((0,i.Z)((0,i.Z)({},E.inputs),{},{name:void 0,image:void 0}),E.inputs.email.isValid&&E.inputs.password.isValid),m((function(e){return!e}))},children:["SWITCH TO ",p?"SIGNUP":"LOGIN"]})]}),(0,c.jsx)(_.Z,{})]})}}}]);
//# sourceMappingURL=721.e6c9851f.chunk.js.map